[
  {
    "slug": "recursos-humanos",
    "questions": [
      {
        "id": 1,
        "enunciado": "Liste todos os nomes das regiões.",
        "resposta_base": "SELECT region_name FROM regions;"
      },
      {
        "id": 2,
        "enunciado": "Liste o ID e o nome de todos os países.",
        "resposta_base": "SELECT country_id, country_name FROM countries;"
      },
      {
        "id": 3,
        "enunciado": "Liste o ID e a cidade de todas as localidades.",
        "resposta_base": "SELECT location_id, city FROM locations;"
      },
      {
        "id": 4,
        "enunciado": "Liste o ID e o nome de todos os departamentos.",
        "resposta_base": "SELECT department_id, department_name FROM departments;"
      },
      {
        "id": 5,
        "enunciado": "Liste o ID e o título de todos os cargos.",
        "resposta_base": "SELECT job_id, job_title FROM jobs;"
      },
      {
        "id": 6,
        "enunciado": "Liste o ID, o primeiro nome e o sobrenome de todos os funcionários.",
        "resposta_base": "SELECT employee_id, first_name, last_name FROM employees;"
      },
      {
        "id": 7,
        "enunciado": "Liste o ID do funcionário e sua data de contratação.",
        "resposta_base": "SELECT employee_id, hire_date FROM employees;"
      },
      {
        "id": 8,
        "enunciado": "Liste o ID do funcionário e o ID do cargo de todas as entradas no histórico de cargos.",
        "resposta_base": "SELECT employee_id, job_id FROM job_history;"
      },
      {
        "id": 9,
        "enunciado": "Liste o nome do departamento e a cidade onde ele está localizado.",
        "resposta_base": "SELECT d.department_name, l.city\nFROM departments d\nJOIN locations l ON d.location_id = l.location_id\nORDER BY d.department_name;"
      },
      {
        "id": 10,
        "enunciado": "Liste os nomes dos países que pertencem à região com ID 2.",
        "resposta_base": "SELECT country_name FROM countries WHERE region_id = 2;"
      },
      {
        "id": 11,
        "enunciado": "Liste cada país e a quantidade de localidades associadas a ele, em ordem decrescente pela quantidade.",
        "resposta_base": "SELECT c.country_id, c.country_name, COUNT(l.location_id) AS num_localidades\nFROM countries c\nJOIN locations l ON l.country_id = c.country_id\nGROUP BY c.country_id, c.country_name\nORDER BY num_localidades DESC;"
      },
      {
        "id": 12,
        "enunciado": "Para cada departamento, exiba o nome do departamento e o salário médio dos funcionários que trabalham nele.",
        "resposta_base": "SELECT d.department_name, ROUND(AVG(e.salary)::numeric,2) AS salario_medio\nFROM departments d\nJOIN employees e ON e.department_id = d.department_id\nGROUP BY d.department_name\nORDER BY salario_medio DESC;"
      },
      {
        "id": 13,
        "enunciado": "Liste o nome completo de cada gerente e a quantidade de subordinados que ele possui, mostrando apenas gerentes com mais de 5 funcionários.",
        "resposta_base": "SELECT CONCAT(m.first_name, ' ', m.last_name) AS nome_gerente, COUNT(e.employee_id) AS num_subordinados\nFROM employees e\nJOIN employees m ON e.manager_id = m.employee_id\nGROUP BY m.employee_id, m.first_name, m.last_name\nHAVING COUNT(e.employee_id) > 5\nORDER BY num_subordinados DESC;"
      },
      {
        "id": 14,
        "enunciado": "Encontre todos os cargos cujo salário mínimo seja maior que 10000, exibindo o ID do cargo, título e o salário mínimo.",
        "resposta_base": "SELECT job_id, job_title, min_salary\nFROM jobs\nWHERE min_salary > 10000\nORDER BY min_salary DESC;"
      },
      {
        "id": 15,
        "enunciado": "Para cada região, liste o nome da região e a quantidade total de funcionários que trabalham em países dessa região.",
        "resposta_base": "SELECT r.region_name, COUNT(e.employee_id) AS total_funcionarios\nLEFT FROM regions r\nLEFT JOIN countries c ON c.region_id = r.region_id\nLEFT JOIN locations l ON l.country_id = c.country_id\nLEFT JOIN departments d ON d.location_id = l.location_id\nLEFT JOIN employees e ON e.department_id = d.department_id\nGROUP BY r.region_name;"
      },
      {
        "id": 16,
        "enunciado": "Liste o nome completo dos funcionários e a quantidade de dias desde a sua data de contratação até hoje.",
        "resposta_base": "SELECT CONCAT(first_name, ' ', last_name) AS nome_completo,\n       (CURRENT_DATE - hire_date) AS dias_na_empresa\nFROM employees\nORDER BY dias_na_empresa DESC;"
      },
      {
        "id": 17,
        "enunciado": "Liste o nome completo dos funcionários que nunca mudaram de cargo (não possuem histórico em job_history).",
        "resposta_base": "SELECT CONCAT(e.first_name, ' ', e.last_name) AS nome_completo\nFROM employees e\nWHERE NOT EXISTS (\n  SELECT 1 FROM job_history j\n  WHERE j.employee_id = e.employee_id\n)\nORDER BY nome_completo;"
      },
      {
        "id": 18,
        "enunciado": "Para cada cargo, exiba o título do cargo, o número de funcionários que o ocupam e a diferença entre o salário máximo e mínimo desse cargo.",
        "resposta_base": "SELECT j.job_title,\n       COUNT(e.employee_id) AS num_empregados,\n       (j.max_salary - j.min_salary) AS faixa_salarial\nFROM jobs j\nLEFT JOIN employees e ON e.job_id = j.job_id\nGROUP BY j.job_title, j.max_salary, j.min_salary\nORDER BY faixa_salarial DESC;"
      },
      {
        "id": 19,
        "enunciado": "Liste o nome completo dos funcionários que já mudaram de cargo (possuem registro em job_history).",
        "resposta_base": "SELECT DISTINCT CONCAT(e.first_name, ' ', e.last_name) AS nome_completo\nFROM employees e\nJOIN job_history j ON e.employee_id = j.employee_id\nORDER BY nome_completo;"
      },
      {
        "id": 20,
        "enunciado": "Para cada departamento, liste os 3 funcionários com maior salário, mostrando nome completo, departamento e salário.",
        "resposta_base": "SELECT nome_completo, department_name, salary FROM (\n  SELECT CONCAT(e.first_name, ' ', e.last_name) AS nome_completo,\n         d.department_name,\n         e.salary,\n         ROW_NUMBER() OVER (PARTITION BY e.department_id ORDER BY e.salary DESC) AS rn\n  FROM employees e\n  JOIN departments d ON e.department_id = d.department_id\n) sub\nWHERE rn <= 3\nORDER BY department_name, salary DESC;"
      },
      {
        "id": 21,
        "enunciado": "Liste os funcionários cujo departamento seja o mesmo que o do seu gerente.",
        "resposta_base": "SELECT e.employee_id, e.first_name, e.last_name FROM employees e JOIN employees m ON e.manager_id = m.employee_id AND e.department_id = m.department_id;"
      },
      {
        "id": 22,
        "enunciado": "Para cada mês do ano, liste o número de funcionários contratados nesse mês (independente do ano).",
        "resposta_base": "SELECT EXTRACT(MONTH FROM hire_date) AS mes, COUNT(*) AS num_contratacoes FROM employees GROUP BY mes ORDER BY mes;"
      },
      {
        "id": 23,
        "enunciado": "Liste os departamentos que nunca tiveram funcionários nem histórico de cargos.",
        "resposta_base": "SELECT d.department_id, d.department_name FROM departments d WHERE NOT EXISTS (SELECT 1 FROM employees e WHERE e.department_id = d.department_id) AND NOT EXISTS (SELECT 1 FROM job_history j WHERE j.department_id = d.department_id) ORDER BY d.department_id;"
      },
      {
        "id": 24,
        "enunciado": "Para cada cargo, exiba o salário médio de comissão (commission_pct) considerando apenas valores não nulos.",
        "resposta_base": "SELECT job_id, ROUND(AVG(commission_pct)::numeric,2) AS comissao_media FROM employees WHERE commission_pct IS NOT NULL GROUP BY job_id ORDER BY job_id;"
      },
      {
        "id": 25,
        "enunciado": "Liste os funcionários cujo salário é maior que a média salarial do seu próprio departamento.",
        "resposta_base": "SELECT e.employee_id, e.first_name, e.salary FROM employees e WHERE e.salary > (SELECT AVG(salary) FROM employees WHERE department_id = e.department_id) ORDER BY e.employee_id;"
      },
      {
        "id": 26,
        "enunciado": "Exiba o funcionário que possui a data de contratação mais antiga.",
        "resposta_base": "SELECT employee_id, first_name, last_name, hire_date FROM employees ORDER BY hire_date ASC LIMIT 1;"
      },
      {
        "id": 27,
        "enunciado": "Liste os 3 funcionários com maior salário no banco.",
        "resposta_base": "SELECT employee_id, first_name, last_name, salary FROM employees ORDER BY salary DESC LIMIT 3;"
      },
      {
        "id": 28,
        "enunciado": "Para cada funcionário, exiba a quantidade de dias que durou seu primeiro período no histórico de cargos.",
        "resposta_base": "SELECT e.employee_id, CONCAT(e.first_name, ' ', e.last_name) AS nome, (j.end_date - j.start_date) AS dias_primeiro_periodo FROM employees e JOIN job_history j ON j.employee_id = e.employee_id WHERE j.start_date = (SELECT MIN(start_date) FROM job_history WHERE employee_id = e.employee_id);"
      },
      {
        "id": 29,
        "enunciado": "Liste os países que não possuem nenhuma localidade cadastrada.",
        "resposta_base": "SELECT country_id, country_name FROM countries c WHERE NOT EXISTS (SELECT 1 FROM locations l WHERE l.country_id = c.country_id) ORDER BY country_id;"
      },
      {
        "id": 30,
        "enunciado": "Para cada departamento, mostre o número de funcionários atuais e o número de entradas em job_history desse departamento.",
        "resposta_base": "SELECT d.department_id, d.department_name, COUNT(DISTINCT e.employee_id) AS num_funcionarios, COUNT(j.employee_id) AS num_historicos FROM departments d LEFT JOIN employees e ON e.department_id = d.department_id LEFT JOIN job_history j ON j.department_id = d.department_id GROUP BY d.department_id, d.department_name ORDER BY d.department_id;"
      },
      {
        "id": 31,
        "enunciado": "Liste cada cidade e a quantidade de departamentos localizados nela.",
        "resposta_base": "SELECT l.city, COUNT(d.department_id) AS num_departamentos\nFROM departments d\nJOIN locations l ON d.location_id = l.location_id\nGROUP BY l.city\nORDER BY num_departamentos DESC;"
      },
      {
        "id": 32,
        "enunciado": "Liste o nome completo do funcionário e o título do cargo para funcionários cujo salário está acima da média de todos os funcionários.",
        "resposta_base": "SELECT CONCAT(e.first_name, ' ', e.last_name) AS nome_completo, j.job_title\nFROM employees e\nJOIN jobs j ON e.job_id = j.job_id\nWHERE e.salary > (SELECT AVG(salary) FROM employees)\nORDER BY e.salary DESC;"
      },
      {
        "id": 33,
        "enunciado": "Para cada país, liste o nome do país e a quantidade de localidades com código postal preenchido.",
        "resposta_base": "SELECT c.country_name, COUNT(l.location_id) AS num_localidades\nFROM countries c\nJOIN locations l ON l.country_id = c.country_id\nWHERE l.postal_code IS NOT NULL\nGROUP BY c.country_name\nORDER BY num_localidades DESC;"
      },
      {
        "id": 34,
        "enunciado": "Liste o nome completo dos funcionários que não recebem comissão.",
        "resposta_base": "SELECT CONCAT(first_name, ' ', last_name) AS nome_completo\nFROM employees\nWHERE commission_pct IS NULL\nORDER BY nome_completo;"
      },
      {
        "id": 35,
        "enunciado": "Liste o nome do departamento e o nome completo do gerente responsável por ele.",
        "resposta_base": "SELECT d.department_name, CONCAT(m.first_name, ' ', m.last_name) AS nome_gerente\nFROM departments d\nJOIN employees m ON d.manager_id = m.employee_id\nORDER BY d.department_name;"
      },
      {
        "id": 36,
        "enunciado": "Liste o nome completo do funcionário e a quantidade de departamentos diferentes em que ele já trabalhou (histórico de cargos), mostrando apenas quem trabalhou em mais de um.",
        "resposta_base": "SELECT CONCAT(e.first_name, ' ', e.last_name) AS nome_completo, COUNT(DISTINCT j.department_id) AS num_departamentos\nFROM employees e\nJOIN job_history j ON e.employee_id = j.employee_id\nGROUP BY e.employee_id, e.first_name, e.last_name\nHAVING COUNT(DISTINCT j.department_id) > 1\nORDER BY num_departamentos DESC;"
      },
      {
        "id": 37,
        "enunciado": "Liste títulos de cargo cujo intervalo salarial (max_salary - min_salary) seja maior que 5000.",
        "resposta_base": "SELECT job_title, (max_salary - min_salary) AS faixa_salarial\nFROM jobs\nWHERE (max_salary - min_salary) > 5000\nORDER BY faixa_salarial DESC;"
      },
      {
        "id": 38,
        "enunciado": "Liste os departamentos e a média de salário dos funcionários em cada um, exibindo 0 para departamentos sem funcionários.",
        "resposta_base": "SELECT d.department_name, COALESCE(ROUND(AVG(e.salary)::numeric,2),0) AS salario_medio\nFROM departments d\nLEFT JOIN employees e ON e.department_id = d.department_id\nGROUP BY d.department_name\nORDER BY salario_medio DESC;"
      },
      {
        "id": 39,
        "enunciado": "Liste os 5 funcionários com a data de contratação mais antiga, mostrando nome completo e data de contratação.",
        "resposta_base": "SELECT CONCAT(first_name, ' ', last_name) AS nome_completo, hire_date\nFROM employees\nORDER BY hire_date ASC\nLIMIT 5;"
      },
      {
        "id": 40,
        "enunciado": "Liste o nome completo de cada funcionário e a cidade em que ele trabalha, com base no departamento.",
        "resposta_base": "SELECT CONCAT(e.first_name, ' ', e.last_name) AS nome_completo, l.city\nFROM employees e\nJOIN departments d ON e.department_id = d.department_id\nJOIN locations l ON d.location_id = l.location_id\nORDER BY nome_completo;"
      }
    ]
  },
  {
    "slug": "universidade",
    "questions": [
      {
        "id": 1,
        "enunciado": "Liste todas as cidades distintas da tabela de endereços.",
        "resposta_base": "SELECT DISTINCT city FROM addresses;"
      },
      {
        "id": 2,
        "enunciado": "Encontre todos os endereços (rua e cidade) localizados em 'Springfield'.",
        "resposta_base": "SELECT street, city FROM addresses WHERE city = 'Springfield';"
      },
      {
        "id": 3,
        "enunciado": "Liste o primeiro nome, sobrenome e email de todos os membros.",
        "resposta_base": "SELECT first_name, last_name, email FROM members;"
      },
      {
        "id": 4,
        "enunciado": "Encontre todos os membros (nome completo) nascidos após 1 de janeiro de 2003.",
        "resposta_base": "SELECT first_name, last_name FROM members WHERE date_of_birth > '2003-01-01';"
      },
      {
        "id": 5,
        "enunciado": "Liste o nome e a abreviação de todos os departamentos.",
        "resposta_base": "SELECT name, abbreviation FROM departments;"
      },
      {
        "id": 6,
        "enunciado": "Liste o nome e os créditos de todos os cursos que valem 3 créditos.",
        "resposta_base": "SELECT course_name, credits FROM courses WHERE credits = 3;"
      },
      {
        "id": 7,
        "enunciado": "Encontre o nome de todos os programas que são do tipo 'Bachelors'.",
        "resposta_base": "SELECT program_name FROM programs WHERE degree_type = 'Bachelors';"
      },
      {
        "id": 8,
        "enunciado": "Liste todos os dados das matrículas onde o aluno foi reprovado.",
        "resposta_base": "SELECT * FROM enrollments WHERE status = 'Failed';"
      },
      {
        "id": 9,
        "enunciado": "Encontre o class_id e student_id das matrículas que tiveram 5 ou mais faltas.",
        "resposta_base": "SELECT class_id, student_id FROM enrollments WHERE absences >= 5;"
      },
      {
        "id": 10,
        "enunciado": "Liste os nomes de todos os cursos ordenados alfabeticamente.",
        "resposta_base": "SELECT course_name FROM courses ORDER BY course_name;"
      },
      {
        "id": 11,
        "enunciado": "Liste o nome completo de todos os membros que são estudantes.",
        "resposta_base": "SELECT m.first_name, m.last_name FROM members m JOIN students s ON m.member_id = s.student_id;"
      },
      {
        "id": 12,
        "enunciado": "Liste o nome completo e o título de todos os membros que são professores.",
        "resposta_base": "SELECT m.first_name, m.last_name, p.title FROM members m JOIN professors p ON m.member_id = p.professor_id;"
      },
      {
        "id": 13,
        "enunciado": "Mostre o nome completo dos professores e o nome do departamento em que trabalham.",
        "resposta_base": "SELECT m.first_name, m.last_name, d.name AS department_name FROM members m JOIN professors p ON m.member_id = p.professor_id JOIN departments d ON p.department_id = d.department_id;"
      },
      {
        "id": 14,
        "enunciado": "Liste o nome completo de todos os professores do departamento de TI.",
        "resposta_base": "SELECT m.first_name, m.last_name FROM members m JOIN professors p ON m.member_id = p.professor_id JOIN departments d ON p.department_id = d.department_id WHERE d.abbreviation = 'IT';"
      },
      {
        "id": 15,
        "enunciado": "Conte quantos professores  existem em cada departamento. Liste o nome do departamento e a contagem.",
        "resposta_base": "SELECT d.name, COUNT(p.professor_id) AS total_professors FROM departments d LEFT JOIN professors p ON d.department_id = p.department_id GROUP BY d.name;"
      },
      {
        "id": 16,
        "enunciado": "Liste o nome de cada programa e o nome completo do seu coordenador.",
        "resposta_base": "SELECT prog.program_name, m.first_name, m.last_name AS coordinator_name FROM programs prog JOIN professors p ON prog.coordinator_id = p.professor_id JOIN members m ON p.professor_id = m.member_id;"
      },
      {
        "id": 17,
        "enunciado": "Encontre o nome do coordenador do programa 'Data Science'.",
        "resposta_base": "SELECT m.first_name, m.last_name FROM members m JOIN professors p ON m.member_id = p.professor_id JOIN programs prog ON p.professor_id = prog.coordinator_id WHERE prog.program_name = 'Data Science';"
      },
      {
        "id": 18,
        "enunciado": "Liste os nomes dos cursos ecionados pelo professor 'Iris Chen'.",
        "resposta_base": "SELECT DISTINCT c.course_name FROM courses c JOIN classes cl ON c.course_id = cl.course_id WHERE cl.professor_id = 33;"
      },
      {
        "id": 19,
        "enunciado": "Calcule a nota média de todos os alunos na turma de ID 1 (Intro to Programming, 2024/2).",
        "resposta_base": "SELECT AVG(grade) FROM enrollments WHERE class_id = 1 AND grade IS NOT NULL;"
      },
      {
        "id": 20,
        "enunciado": "Liste o nome completo de todos os alunos que estão 'Enrolled' (matriculados) na turma (class_id) 5 (Data Structures).",
        "resposta_base": "SELECT m.first_name, m.last_name FROM members m JOIN enrollments e ON m.member_id = e.student_id WHERE e.class_id = 5 AND e.status = 'Enrolled';"
      },
      {
        "id": 21,
        "enunciado": "Liste o nome completo de todos os alunos que foram reprovados ('Failed') em qualquer disciplina.",
        "resposta_base": "SELECT DISTINCT m.first_name, m.last_name FROM members m JOIN enrollments e ON m.member_id = e.student_id WHERE e.status = 'Failed';"
      },
      {
        "id": 22,
        "enunciado": "Conte quantos alunos estão matriculados ('Enrolled') em cada turma (class_id) no semestre '2025/1'. Liste o class_id e a contagem.",
        "resposta_base": "SELECT cl.class_id, COUNT(e.student_id) AS student_count FROM classes cl JOIN enrollments e ON cl.class_id = e.class_id WHERE cl.semester = '2025/1' AND e.status = 'Enrolled' GROUP BY cl.class_id;"
      },
      {
        "id": 23,
        "enunciado": "Liste o nome de todos os cursos (course_name) que são pré-requisitos para 'Data Structures' (course_id 2).",
        "resposta_base": "SELECT c_pre.course_name FROM courses c_pre JOIN course_prerequisites cp ON c_pre.course_id = cp.prerequisite_course_id WHERE cp.course_id = 2;"
      },
      {
        "id": 24,
        "enunciado": "Liste o nome de todos os cursos (course_name) para os quais 'Calculus I' (course_id 6) é um pré-requisito.",
        "resposta_base": "SELECT c.course_name FROM courses c JOIN course_prerequisites cp ON c.course_id = cp.course_id WHERE cp.prerequisite_course_id = 6;"
      },
      {
        "id": 25,
        "enunciado": "Encontre a rua (street) e a cidade (city) onde mora o membro 'Michael Johnson'.",
        "resposta_base": "SELECT a.street, a.city FROM addresses a JOIN members m ON a.address_id = m.address_id WHERE m.first_name = 'Michael' AND m.last_name = 'Johnson';"
      },
      {
        "id": 26,
        "enunciado": "Liste todos os programas (program_name) oferecidos pelo departamento 'Mathematics' (MATH).",
        "resposta_base": "SELECT p.program_name FROM programs p JOIN departments d ON p.department_id = d.department_id WHERE d.abbreviation = 'MATH';"
      },
      {
        "id": 27,
        "enunciado": "Liste o nome completo dos alunos e suas notas (grade) na turma (class_id) 2 (Calculus I).",
        "resposta_base": "SELECT m.first_name, m.last_name, e.grade FROM members m JOIN enrollments e ON m.member_id = e.student_id WHERE e.class_id = 2;"
      },
      {
        "id": 28,
        "enunciado": "Encontre o nome de todos os cursos (course_name) que estão sendo oferecidos (possuem turmas) no semestre '2025/1'. Use DISTINCT.",
        "resposta_base": "SELECT DISTINCT c.course_name FROM courses c JOIN classes cl ON c.course_id = cl.course_id WHERE cl.semester = '2025/1';"
      },
      {
        "id": 29,
        "enunciado": "Liste o nome completo de todos os alunos que desistiram ('Withdrawn') de 'Web Development' (course_id 14).",
        "resposta_base": "SELECT m.first_name, m.last_name FROM members m JOIN enrollments e ON m.member_id = e.student_id JOIN classes cl ON e.class_id = cl.class_id WHERE e.status = 'Withdrawn' AND cl.course_id = 14;"
      },
      {
        "id": 30,
        "enunciado": "Encontre o nome e a descrição dos cursos (courses) que não possuem pré-requisitos (não estão na coluna course_id de course_prerequisites).",
        "resposta_base": "SELECT c.course_name, c.course_description FROM courses c LEFT JOIN course_prerequisites cp ON c.course_id = cp.course_id WHERE cp.course_id IS NULL;"
      },
      {
        "id": 31,
        "enunciado": "Liste o nome completo dos alunos e os nomes dos cursos (course_name) em que estão atualmente 'Enrolled' (Matriculados).",
        "resposta_base": "SELECT m.first_name, m.last_name, c.course_name FROM members m JOIN enrollments e ON m.member_id = e.student_id JOIN classes cl ON e.class_id = cl.class_id JOIN courses c ON cl.course_id = c.course_id WHERE e.status = 'Enrolled';"
      },
      {
        "id": 32,
        "enunciado": "Calcule a nota média (grade) de alunos 'Passed' (Aprovados) para cada professor no semestre '2024/2'. Liste o nome do professor e a média.",
        "resposta_base": "SELECT m.first_name, m.last_name, AVG(e.grade) AS average_grade FROM members m JOIN professors p ON m.member_id = p.professor_id JOIN classes cl ON p.professor_id = cl.professor_id JOIN enrollments e ON cl.class_id = e.class_id WHERE cl.semester = '2024/2' AND e.status = 'Passed' GROUP BY m.member_id, m.first_name, m.last_name;"
      },
      {
        "id": 33,
        "enunciado": "Encontre o professor (nome completo) que leciona para o maior número de alunos (soma de matrículas 'Enrolled') no semestre '2025/1'.",
        "resposta_base": "SELECT m.first_name, m.last_name, COUNT(e.student_id) AS student_count FROM members m JOIN professors p ON m.member_id = p.professor_id JOIN classes cl ON p.professor_id = cl.professor_id JOIN enrollments e ON cl.class_id = e.class_id WHERE cl.semester = '2025/1' AND e.status = 'Enrolled' GROUP BY m.member_id, m.first_name, m.last_name ORDER BY student_count DESC LIMIT 1;"
      },
      {
        "id": 34,
        "enunciado": "Liste os alunos (nome completo) que estão 'Enrolled' em 'Data Structures' (ID 2) e que já 'Failed' (Reprovaram) em 'Introduction to Programming' (ID 1) em algum momento.",
        "resposta_base": "SELECT m.first_name, m.last_name FROM members m JOIN students s ON m.member_id = s.student_id WHERE s.student_id IN (SELECT e.student_id FROM enrollments e JOIN classes cl ON e.class_id = cl.class_id WHERE cl.course_id = 2 AND e.status = 'Enrolled') AND s.student_id IN (SELECT e.student_id FROM enrollments e JOIN classes cl ON e.class_id = cl.class_id WHERE cl.course_id = 1 AND e.status = 'Failed');"
      },
      {
        "id": 35,
        "enunciado": "Encontre o curso (course_name) com a maior taxa de reprovação (percentual de 'Failed') no semestre '2024/2'.",
        "resposta_base": "SELECT c.course_name, (SUM(CASE WHEN e.status = 'Failed' THEN 1 ELSE 0 END) * 100.0 / COUNT(e.student_id)) AS failure_rate FROM courses c JOIN classes cl ON c.course_id = cl.course_id JOIN enrollments e ON cl.class_id = e.class_id WHERE cl.semester = '2024/2' GROUP BY c.course_id, c.course_name ORDER BY failure_rate DESC LIMIT 1;"
      },
      {
        "id": 36,
        "enunciado": "Liste os nomes de todos os alunos (students) que NÃO estão matriculados (enrolled) em NENHUMA turma (class) no semestre '2025/1'.",
        "resposta_base": "SELECT m.first_name, m.last_name FROM members m JOIN students s ON m.member_id = s.student_id WHERE s.student_id NOT IN (SELECT DISTINCT e.student_id FROM enrollments e JOIN classes cl ON e.class_id = cl.class_id WHERE cl.semester = '2025/1');"
      },
      {
        "id": 37,
        "enunciado": "Liste o nome dos programas (program_name), o nome completo do coordenador e o nome do departamento do coordenador.",
        "resposta_base": "SELECT prog.program_name, m.first_name AS coord_name, m.last_name AS coord_lastname, d.name AS coord_dept_name FROM programs prog JOIN professors p ON prog.coordinator_id = p.professor_id JOIN members m ON p.professor_id = m.member_id JOIN departments d ON p.department_id = d.department_id;"
      },
      {
        "id": 38,
        "enunciado": "Liste alunos (nome completo) que estão 'Enrolled' em turmas (classes) de programas (programs) de pelo menos dois departamentos (departments) diferentes no semestre '2025/1'.",
        "resposta_base": "SELECT m.first_name, m.last_name FROM members m JOIN enrollments e ON m.member_id = e.student_id JOIN classes cl ON e.class_id = cl.class_id JOIN programs p ON cl.program_id = p.program_id WHERE e.status = 'Enrolled' AND cl.semester = '2025/1' GROUP BY m.member_id, m.first_name, m.last_name HAVING COUNT(DISTINCT p.department_id) >= 2;"
      },
      {
        "id": 39,
        "enunciado": "Encontre o nome completo dos alunos (students) que moram na mesma cidade (city) que o professor 'Dr. Evelyn Reed' (professor_id 31).",
        "resposta_base": "SELECT m_stud.first_name, m_stud.last_name FROM members m_stud JOIN addresses a_stud ON m_stud.address_id = a_stud.address_id JOIN students s ON m_stud.member_id = s.student_id WHERE a_stud.city = (SELECT a_prof.city FROM addresses a_prof JOIN members m_prof ON a_prof.address_id = m_prof.address_id WHERE m_prof.member_id = 31);"
      },
      {
        "id": 40,
        "enunciado": "Encontre alunos (nome completo) que moram na mesma cidade (city) que o coordenador (professor) do programa (program) em que estão matriculados (em qualquer turma).",
        "resposta_base": "SELECT DISTINCT m_stud.first_name, m_stud.last_name FROM members m_stud JOIN addresses a_stud ON m_stud.address_id = a_stud.address_id JOIN enrollments e ON m_stud.member_id = e.student_id JOIN classes cl ON e.class_id = cl.class_id JOIN programs p ON cl.program_id = p.program_id JOIN members m_coord ON p.coordinator_id = m_coord.member_id JOIN addresses a_coord ON m_coord.address_id = a_coord.address_id WHERE a_stud.city = a_coord.city;"
      }
    ]
  }
]
