[
  {
    "slug": "recursos-humanos",
    "questions": [
      {
        "id": 1,
        "enunciado": "Liste todos os nomes das regiões cadastradas no sistema.",
        "resposta_base": "SELECT region_name FROM regions;"
      },
      {
        "id": 2,
        "enunciado": "Liste o ID e o nome de todos os países.",
        "resposta_base": "SELECT country_id, country_name FROM countries;"
      },
      {
        "id": 3,
        "enunciado": "Liste o ID, a cidade e o estado/província de todas as localidades.",
        "resposta_base": "SELECT location_id, city, state_province FROM locations;"
      },
      {
        "id": 4,
        "enunciado": "Liste o ID e o nome de todos os departamentos, ordenados alfabeticamente pelo nome.",
        "resposta_base": "SELECT department_id, department_name FROM departments ORDER BY department_name;"
      },
      {
        "id": 5,
        "enunciado": "Liste o título do cargo, o salário mínimo e o salário máximo para cada função.",
        "resposta_base": "SELECT job_title, min_salary, max_salary FROM jobs;"
      },
      {
        "id": 6,
        "enunciado": "Liste o nome, sobrenome e data de contratação de todos os funcionários.",
        "resposta_base": "SELECT first_name, last_name, hire_date FROM employees;"
      },
      {
        "id": 7,
        "enunciado": "Liste os funcionários contratados no ano de 1999 ou depois.",
        "resposta_base": "SELECT first_name, last_name, hire_date FROM employees WHERE hire_date >= '1999-01-01';"
      },
      {
        "id": 8,
        "enunciado": "Liste o nome completo e o salário dos funcionários que ganham entre 5000 e 10000.",
        "resposta_base": "SELECT first_name, last_name, salary FROM employees WHERE salary BETWEEN 5000 AND 10000;"
      },
      {
        "id": 9,
        "enunciado": "Liste o nome do departamento e a cidade onde ele está localizado (utilize JOIN).",
        "resposta_base": "SELECT d.department_name, l.city FROM departments d JOIN locations l ON d.location_id = l.location_id;"
      },
      {
        "id": 10,
        "enunciado": "Liste o nome dos países que ficam na região 'Europe'.",
        "resposta_base": "SELECT c.country_name FROM countries c JOIN regions r ON c.region_id = r.region_id WHERE r.region_name = 'Europe';"
      },
      {
        "id": 11,
        "enunciado": "Crie uma coluna chamada 'Status' que mostre 'Executivo' se o salário for maior que 15000 e 'Geral' caso contrário (Use CASE).",
        "resposta_base": "SELECT first_name, salary, CASE WHEN salary > 15000 THEN 'Executivo' ELSE 'Geral' END AS status FROM employees;"
      },
      {
        "id": 12,
        "enunciado": "Liste o nome dos funcionários e o valor da comissão. Se a comissão for nula, exiba 0 (Use COALESCE).",
        "resposta_base": "SELECT first_name, COALESCE(commission_pct, 0) AS comissao FROM employees;"
      },
      {
        "id": 13,
        "enunciado": "Liste os funcionários cujo nome tem 5 letras e começa com 'S' (Use LIKE ou funções de string).",
        "resposta_base": "SELECT first_name FROM employees WHERE first_name LIKE 'S____';"
      },
      {
        "id": 14,
        "enunciado": "Exiba o nome completo formatado como 'Sobrenome, Nome' (ex: KING, Steven). Use UPPER para o sobrenome.",
        "resposta_base": "SELECT UPPER(last_name) || ', ' || first_name AS nome_completo FROM employees;"
      },
      {
        "id": 15,
        "enunciado": "Liste os departamentos que possuem média salarial superior a 8000.",
        "resposta_base": "SELECT d.department_name, AVG(e.salary) AS media FROM departments d JOIN employees e ON d.department_id = e.department_id GROUP BY d.department_name HAVING AVG(e.salary) > 8000;"
      },
      {
        "id": 16,
        "enunciado": "Liste o nome do funcionário e quantos anos completos ele tem de empresa (Use EXTRACT ou cálculo de data).",
        "resposta_base": "SELECT first_name, EXTRACT(YEAR FROM CURRENT_DATE) - EXTRACT(YEAR FROM hire_date) AS anos_empresa FROM employees;"
      },
      {
        "id": 17,
        "enunciado": "Liste os gerentes e a quantidade de funcionários que eles supervisionam.",
        "resposta_base": "SELECT m.first_name AS gerente, COUNT(e.employee_id) AS total_subordinados FROM employees e JOIN employees m ON e.manager_id = m.employee_id GROUP BY m.first_name ORDER BY total_subordinados DESC;"
      },
      {
        "id": 18,
        "enunciado": "Liste o nome dos cargos e o salário médio pago para esse cargo, arredondado para 2 casas decimais.",
        "resposta_base": "SELECT j.job_title, ROUND(AVG(e.salary), 2) AS salario_medio FROM jobs j JOIN employees e ON j.job_id = e.job_id GROUP BY j.job_title;"
      },
      {
        "id": 19,
        "enunciado": "Liste os funcionários que foram contratados no mês de Junho (independente do ano).",
        "resposta_base": "SELECT first_name, hire_date FROM employees WHERE EXTRACT(MONTH FROM hire_date) = 6;"
      },
      {
        "id": 20,
        "enunciado": "Exiba o salário anual projetado (salário * 12) + bônus fixo de 1000 para todos os funcionários.",
        "resposta_base": "SELECT first_name, (salary * 12) + 1000 AS remuneracao_anual FROM employees;"
      },
      {
        "id": 21,
        "enunciado": "Liste os funcionários que ganham mais do que a média salarial de toda a empresa (Subquery Simples).",
        "resposta_base": "SELECT first_name, salary FROM employees WHERE salary > (SELECT AVG(salary) FROM employees);"
      },
      {
        "id": 22,
        "enunciado": "Liste os departamentos que não possuem nenhum funcionário alocado (Use NOT EXISTS ou LEFT JOIN com NULL).",
        "resposta_base": "SELECT d.department_name FROM departments d LEFT JOIN employees e ON d.department_id = e.department_id WHERE e.employee_id IS NULL;"
      },
      {
        "id": 23,
        "enunciado": "Liste os nomes dos funcionários que trabalham no departamento 'Sales' (sem usar o ID fixo, use Join).",
        "resposta_base": "SELECT e.first_name, e.last_name FROM employees e JOIN departments d ON e.department_id = d.department_id WHERE d.department_name = 'Sales';"
      },
      {
        "id": 24,
        "enunciado": "Exiba o 'Country Name' e a quantidade de cidades cadastradas para aquele país.",
        "resposta_base": "SELECT c.country_name, COUNT(l.city) AS qtd_cidades FROM countries c JOIN locations l ON c.country_id = l.country_id GROUP BY c.country_name;"
      },
      {
        "id": 25,
        "enunciado": "Liste os funcionários que têm o mesmo sobrenome, mas IDs diferentes (Self Join ou Subquery).",
        "resposta_base": "SELECT e1.first_name, e1.last_name FROM employees e1 JOIN employees e2 ON e1.last_name = e2.last_name AND e1.employee_id <> e2.employee_id;"
      },
      {
        "id": 26,
        "enunciado": "Liste os funcionários que foram contratados ANTES do seu próprio gerente (Self Join com comparação de datas).",
        "resposta_base": "SELECT e.first_name AS funcionario, e.hire_date, m.first_name AS gerente, m.hire_date AS data_gerente FROM employees e JOIN employees m ON e.manager_id = m.employee_id WHERE e.hire_date < m.hire_date;"
      },
      {
        "id": 27,
        "enunciado": "Classifique os salários em 3 grupos: 'A' (< 5000), 'B' (5000-10000), 'C' (> 10000) e conte quantos funcionários há em cada grupo.",
        "resposta_base": "SELECT CASE WHEN salary < 5000 THEN 'A' WHEN salary BETWEEN 5000 AND 10000 THEN 'B' ELSE 'C' END AS faixa, COUNT(*) FROM employees GROUP BY 1 ORDER BY 1;"
      },
      {
        "id": 28,
        "enunciado": "Liste o nome do departamento que possui o funcionário com o maior salário da empresa (Subquery).",
        "resposta_base": "SELECT d.department_name FROM departments d JOIN employees e ON d.department_id = e.department_id WHERE e.salary = (SELECT MAX(salary) FROM employees);"
      },
      {
        "id": 29,
        "enunciado": "Exiba o primeiro nome e o email (em letras minúsculas) concatenado com '@company.com'.",
        "resposta_base": "SELECT first_name, LOWER(email) || '@company.com' AS email_corporativo FROM employees;"
      },
      {
        "id": 30,
        "enunciado": "Liste os cargos (jobs) que possuem uma diferença entre salário máximo e mínimo superior a 5000.",
        "resposta_base": "SELECT job_title, (max_salary - min_salary) AS diferenca FROM jobs WHERE (max_salary - min_salary) > 5000;"
      },
      {
        "id": 31,
        "enunciado": "Liste o funcionário que tem o maior salário dentro de cada departamento (Correlated Subquery).",
        "resposta_base": "SELECT e.first_name, e.salary, e.department_id FROM employees e WHERE e.salary = (SELECT MAX(salary) FROM employees WHERE department_id = e.department_id);"
      },
      {
        "id": 32,
        "enunciado": "Encontre a cidade que possui o maior número de departamentos (use LIMIT).",
        "resposta_base": "SELECT l.city, COUNT(d.department_id) AS qtd FROM locations l JOIN departments d ON l.location_id = d.location_id GROUP BY l.city ORDER BY qtd DESC LIMIT 1;"
      },
      {
        "id": 33,
        "enunciado": "Liste todos os funcionários que já mudaram de cargo no passado (estão na tabela job_history).",
        "resposta_base": "SELECT e.first_name, e.last_name FROM employees e WHERE e.employee_id IN (SELECT employee_id FROM job_history);"
      },
      {
        "id": 34,
        "enunciado": "Calcule a média salarial por ano de contratação (extraia o ano da data).",
        "resposta_base": "SELECT EXTRACT(YEAR FROM hire_date) AS ano, AVG(salary) FROM employees GROUP BY EXTRACT(YEAR FROM hire_date) ORDER BY ano;"
      },
      {
        "id": 35,
        "enunciado": "Liste os funcionários cujo salário é igual ao salário mínimo do seu cargo (jobs).",
        "resposta_base": "SELECT e.first_name, e.salary, j.job_title FROM employees e JOIN jobs j ON e.job_id = j.job_id WHERE e.salary = j.min_salary;"
      },
      {
        "id": 36,
        "enunciado": "Exiba o nome do funcionário e o nome do departamento. Se não tiver departamento, exiba 'Sem Departamento' (Left Join + Coalesce).",
        "resposta_base": "SELECT e.first_name, COALESCE(d.department_name, 'Sem Departamento') FROM employees e LEFT JOIN departments d ON e.department_id = d.department_id;"
      },
      {
        "id": 37,
        "enunciado": "Liste o histórico de cargos do funcionário 101, mostrando o título do cargo antigo e o nome do departamento antigo.",
        "resposta_base": "SELECT jh.start_date, jh.end_date, j.job_title, d.department_name FROM job_history jh JOIN jobs j ON jh.job_id = j.job_id JOIN departments d ON jh.department_id = d.department_id WHERE jh.employee_id = 101;"
      },
      {
        "id": 38,
        "enunciado": "Liste os departamentos onde a soma dos salários é maior que a soma dos salários do departamento 50.",
        "resposta_base": "SELECT department_id, SUM(salary) FROM employees GROUP BY department_id HAVING SUM(salary) > (SELECT SUM(salary) FROM employees WHERE department_id = 50);"
      },
      {
        "id": 39,
        "enunciado": "Liste os funcionários que não recebem comissão e trabalham em departamentos localizados nos Estados Unidos (US).",
        "resposta_base": "SELECT e.first_name FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN locations l ON d.location_id = l.location_id WHERE e.commission_pct IS NULL AND l.country_id = 'US';"
      },
      {
        "id": 40,
        "enunciado": "Liste o nome completo e o cargo atual dos funcionários que trabalharam anteriormente como 'Programmer' (job_id = IT_PROG no histórico).",
        "resposta_base": "SELECT e.first_name, e.last_name, j.job_title FROM employees e JOIN jobs j ON e.job_id = j.job_id WHERE EXISTS (SELECT 1 FROM job_history jh WHERE jh.employee_id = e.employee_id AND jh.job_id = 'IT_PROG');"
      }
    ]
  },
  {
    "slug": "universidade",
    "questions": [
      {
        "id": 1,
        "enunciado": "Liste todas as cidades distintas presentes na tabela de endereços.",
        "resposta_base": "SELECT DISTINCT city FROM addresses;"
      },
      {
        "id": 2,
        "enunciado": "Liste o nome e a abreviação de todos os departamentos.",
        "resposta_base": "SELECT name, abbreviation FROM departments;"
      },
      {
        "id": 3,
        "enunciado": "Encontre o primeiro nome, sobrenome e e-mail de todos os membros.",
        "resposta_base": "SELECT first_name, last_name, email FROM members;"
      },
      {
        "id": 4,
        "enunciado": "Liste os cursos que valem mais de 3 créditos.",
        "resposta_base": "SELECT course_name, credits FROM courses WHERE credits > 3;"
      },
      {
        "id": 5,
        "enunciado": "Liste o ID e a nota (grade) de todas as matrículas onde a nota não é nula, ordenado da maior para a menor.",
        "resposta_base": "SELECT student_id, class_id, grade FROM enrollments WHERE grade IS NOT NULL ORDER BY grade DESC;"
      },
      {
        "id": 6,
        "enunciado": "Liste os membros que nasceram antes do ano 2000.",
        "resposta_base": "SELECT first_name, last_name, date_of_birth FROM members WHERE date_of_birth < '2000-01-01';"
      },
      {
        "id": 7,
        "enunciado": "Liste os programas do tipo 'Bachelors' oferecidos pelo departamento com ID 1.",
        "resposta_base": "SELECT program_name FROM programs WHERE degree_type = 'Bachelors' AND department_id = 1;"
      },
      {
        "id": 8,
        "enunciado": "Encontre as turmas (classes) agendadas para a sala (room) '101A'.",
        "resposta_base": "SELECT class_id, semester, schedule FROM classes WHERE room = '101A';"
      },
      {
        "id": 9,
        "enunciado": "Liste as matrículas com status 'Failed' ou que tenham mais de 10 faltas (absences).",
        "resposta_base": "SELECT * FROM enrollments WHERE status = 'Failed' OR absences > 10;"
      },
      {
        "id": 10,
        "enunciado": "Concatene o primeiro e o último nome dos membros em uma coluna chamada 'nome_completo'.",
        "resposta_base": "SELECT first_name || ' ' || last_name AS nome_completo FROM members;"
      },
      {
        "id": 11,
        "enunciado": "Liste o nome completo dos alunos e a data de início do curso.",
        "resposta_base": "SELECT m.first_name, m.last_name, s.start_date FROM members m JOIN students s ON m.member_id = s.student_id;"
      },
      {
        "id": 12,
        "enunciado": "Liste o nome do professor e o nome do departamento ao qual ele pertence.",
        "resposta_base": "SELECT m.first_name, d.name AS departamento FROM members m JOIN professors p ON m.member_id = p.professor_id JOIN departments d ON p.department_id = d.department_id;"
      },
      {
        "id": 13,
        "enunciado": "Exiba o nome do curso e o nome do seu pré-requisito (Self Join).",
        "resposta_base": "SELECT c.course_name AS curso, pre.course_name AS pre_requisito FROM courses c JOIN course_prerequisites cp ON c.course_id = cp.course_id JOIN courses pre ON cp.prerequisite_course_id = pre.course_id;"
      },
      {
        "id": 14,
        "enunciado": "Calcule a idade atual de cada membro utilizando a data de nascimento (Use EXTRACT ou Age).",
        "resposta_base": "SELECT first_name, last_name, EXTRACT(YEAR FROM CURRENT_DATE) - EXTRACT(YEAR FROM date_of_birth) AS idade_aproximada FROM members;"
      },
      {
        "id": 15,
        "enunciado": "Liste o nome dos programas e o nome completo do coordenador responsável, formatado como 'SOBRENOME, Nome' (Use UPPER).",
        "resposta_base": "SELECT p.program_name, UPPER(m.last_name) || ', ' || m.first_name AS coordenador FROM programs p JOIN members m ON p.coordinator_id = m.member_id;"
      },
      {
        "id": 16,
        "enunciado": "Conte quantos alunos estão matriculados em cada programa (Group By).",
        "resposta_base": "SELECT p.program_name, COUNT(s.student_id) AS total_alunos FROM programs p JOIN students s ON p.program_id = s.program_id GROUP BY p.program_name;"
      },
      {
        "id": 17,
        "enunciado": "Liste as turmas (ID e Semestre) que possuem média de notas superior a 7.0.",
        "resposta_base": "SELECT class_id, semester, AVG(grade) AS media_turma FROM enrollments GROUP BY class_id, semester HAVING AVG(grade) > 7.0;"
      },
      {
        "id": 18,
        "enunciado": "Liste o nome completo dos membros que moram na cidade de 'Springfield' (Join com Addresses).",
        "resposta_base": "SELECT m.first_name, m.last_name FROM members m JOIN addresses a ON m.address_id = a.address_id WHERE a.city = 'Springfield';"
      },
      {
        "id": 19,
        "enunciado": "Exiba a nota final dos alunos. Se a nota for nula, exiba 0 (Use COALESCE).",
        "resposta_base": "SELECT student_id, class_id, COALESCE(grade, 0) AS nota_final FROM enrollments;"
      },
      {
        "id": 20,
        "enunciado": "Liste os professores que foram contratados no mesmo ano que o coordenador do departamento deles.",
        "resposta_base": "SELECT m.first_name, p.start_date FROM professors p JOIN members m ON p.professor_id = m.member_id JOIN programs prog ON p.department_id = prog.department_id JOIN professors coord ON prog.coordinator_id = coord.professor_id WHERE EXTRACT(YEAR FROM p.start_date) = EXTRACT(YEAR FROM coord.start_date);"
      },
      {
        "id": 21,
        "enunciado": "Crie uma coluna 'Situacao' que mostre 'Aprovado' para notas >= 6 e 'Reprovado' para notas < 6 (Use CASE).",
        "resposta_base": "SELECT student_id, class_id, grade, CASE WHEN grade >= 6 THEN 'Aprovado' ELSE 'Reprovado' END AS situacao FROM enrollments WHERE grade IS NOT NULL;"
      },
      {
        "id": 22,
        "enunciado": "Liste os cursos que NÃO possuem pré-requisitos (Use LEFT JOIN com verificação de NULL).",
        "resposta_base": "SELECT c.course_name FROM courses c LEFT JOIN course_prerequisites cp ON c.course_id = cp.course_id WHERE cp.prerequisite_course_id IS NULL;"
      },
      {
        "id": 23,
        "enunciado": "Liste o nome completo e e-mail dos membros cujo e-mail termina com '@university.edu' (Use LIKE).",
        "resposta_base": "SELECT first_name, last_name, email FROM members WHERE email LIKE '%@university.edu';"
      },
      {
        "id": 24,
        "enunciado": "Encontre o departamento que tem o maior número de cursos ofertados (Limit 1).",
        "resposta_base": "SELECT d.name, COUNT(p.program_id) AS qtd_programas FROM departments d JOIN programs p ON d.department_id = p.department_id GROUP BY d.name ORDER BY qtd_programas DESC LIMIT 1;"
      },
      {
        "id": 25,
        "enunciado": "Liste os alunos que nunca tiveram nenhuma falta (absences = 0) em nenhuma matrícula.",
        "resposta_base": "SELECT m.first_name, m.last_name FROM members m JOIN enrollments e ON m.member_id = e.student_id WHERE e.absences = 0;"
      },
      {
        "id": 26,
        "enunciado": "Calcule a taxa de reprovação (percentual de status 'Failed') por curso (Use CASE dentro de SUM).",
        "resposta_base": "SELECT c.course_name, (SUM(CASE WHEN e.status = 'Failed' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) AS taxa_reprovacao FROM courses c JOIN classes cl ON c.course_id = cl.course_id JOIN enrollments e ON cl.class_id = e.class_id GROUP BY c.course_name;"
      },
      {
        "id": 27,
        "enunciado": "Liste os alunos que estão matriculados em turmas de departamentos diferentes do departamento do seu programa principal.",
        "resposta_base": "SELECT DISTINCT m.first_name, m.last_name FROM students s JOIN members m ON s.student_id = m.member_id JOIN programs p_aluno ON s.program_id = p_aluno.program_id JOIN enrollments e ON s.student_id = e.student_id JOIN classes cl ON e.class_id = cl.class_id JOIN courses c ON cl.course_id = c.course_id JOIN programs p_curso ON cl.program_id = p_curso.program_id WHERE p_aluno.department_id <> p_curso.department_id;"
      },
      {
        "id": 28,
        "enunciado": "Liste os professores que lecionam mais de 3 turmas em um único semestre.",
        "resposta_base": "SELECT m.first_name, cl.semester, COUNT(cl.class_id) FROM professors p JOIN members m ON p.professor_id = m.member_id JOIN classes cl ON p.professor_id = cl.professor_id GROUP BY m.first_name, cl.semester HAVING COUNT(cl.class_id) > 3;"
      },
      {
        "id": 29,
        "enunciado": "Liste o nome completo dos alunos que não estão matriculados em nenhuma turma atualmente (Use NOT EXISTS ou NOT IN).",
        "resposta_base": "SELECT m.first_name, m.last_name FROM members m JOIN students s ON m.member_id = s.student_id WHERE s.student_id NOT IN (SELECT student_id FROM enrollments WHERE status = 'Enrolled');"
      },
      {
        "id": 30,
        "enunciado": "Liste o nome dos cursos que são pré-requisitos para mais de um outro curso.",
        "resposta_base": "SELECT c.course_name, COUNT(cp.course_id) AS qtd_dependencias FROM courses c JOIN course_prerequisites cp ON c.course_id = cp.prerequisite_course_id GROUP BY c.course_name HAVING COUNT(cp.course_id) > 1;"
      },
      {
        "id": 31,
        "enunciado": "Exiba o histórico escolar de um aluno (ex: ID 10) mostrando Semestre, Curso, Nota e Status, ordenado pelo semestre.",
        "resposta_base": "SELECT cl.semester, c.course_name, e.grade, e.status FROM enrollments e JOIN classes cl ON e.class_id = cl.class_id JOIN courses c ON cl.course_id = c.course_id WHERE e.student_id = 10 ORDER BY cl.semester;"
      },
      {
        "id": 32,
        "enunciado": "Liste os departamentos onde a soma dos créditos de todos os programas é maior que 100.",
        "resposta_base": "SELECT d.name, SUM(p.credits) FROM departments d JOIN programs p ON d.department_id = p.department_id GROUP BY d.name HAVING SUM(p.credits) > 100;"
      },
      {
        "id": 33,
        "enunciado": "Encontre o aluno com a maior média de notas acumulada em toda a universidade.",
        "resposta_base": "SELECT m.first_name, AVG(e.grade) AS media_geral FROM members m JOIN enrollments e ON m.member_id = e.student_id WHERE e.grade IS NOT NULL GROUP BY m.member_id, m.first_name ORDER BY media_geral DESC LIMIT 1;"
      },
      {
        "id": 34,
        "enunciado": "Liste os professores que moram na mesma cidade que a universidade (considerando 'Springfield' como a cidade da uni).",
        "resposta_base": "SELECT m.first_name, m.last_name, a.city FROM professors p JOIN members m ON p.professor_id = m.member_id JOIN addresses a ON m.address_id = a.address_id WHERE a.city = 'Springfield';"
      },
      {
        "id": 35,
        "enunciado": "Liste os cursos que nunca tiveram nenhum aluno reprovado ('Failed').",
        "resposta_base": "SELECT c.course_name FROM courses c WHERE NOT EXISTS (SELECT 1 FROM classes cl JOIN enrollments e ON cl.class_id = e.class_id WHERE cl.course_id = c.course_id AND e.status = 'Failed');"
      },
      {
        "id": 36,
        "enunciado": "Classifique as turmas por tamanho: 'Pequena' (<10 alunos), 'Média' (10-30), 'Grande' (>30) (Use CASE e Subquery).",
        "resposta_base": "SELECT class_id, qtd_alunos, CASE WHEN qtd_alunos < 10 THEN 'Pequena' WHEN qtd_alunos BETWEEN 10 AND 30 THEN 'Média' ELSE 'Grande' END AS tamanho FROM (SELECT class_id, COUNT(student_id) as qtd_alunos FROM enrollments GROUP BY class_id) sub;"
      },
      {
        "id": 37,
        "enunciado": "Liste os alunos que reprovaram em uma disciplina e a cursaram novamente (aprovados ou não) em um semestre posterior.",
        "resposta_base": "SELECT DISTINCT m.first_name, c.course_name FROM members m JOIN enrollments e1 ON m.member_id = e1.student_id JOIN classes cl1 ON e1.class_id = cl1.class_id JOIN enrollments e2 ON m.member_id = e2.student_id JOIN classes cl2 ON e2.class_id = cl2.class_id JOIN courses c ON cl1.course_id = c.course_id WHERE e1.status = 'Failed' AND cl1.course_id = cl2.course_id AND cl2.semester > cl1.semester;"
      },
      {
        "id": 38,
        "enunciado": "Identifique se existem membros que são, ao mesmo tempo, Alunos e Professores (Interseção de IDs).",
        "resposta_base": "SELECT m.first_name, m.last_name FROM members m WHERE m.member_id IN (SELECT student_id FROM students) AND m.member_id IN (SELECT professor_id FROM professors);"
      },
      {
        "id": 39,
        "enunciado": "Liste os coordenadores de programas que também lecionam aulas no mesmo programa que coordenam.",
        "resposta_base": "SELECT m.first_name AS coordenador, p.program_name FROM programs p JOIN professors prof ON p.coordinator_id = prof.professor_id JOIN members m ON prof.professor_id = m.member_id JOIN classes cl ON prof.professor_id = cl.professor_id WHERE cl.program_id = p.program_id;"
      },
      {
        "id": 40,
        "enunciado": "Liste o nome do aluno e o nome do professor orientador (Coordenador do programa do aluno), mas apenas se morarem na mesma cidade.",
        "resposta_base": "SELECT m_aluno.first_name AS aluno, m_prof.first_name AS coordenador, a_aluno.city FROM students s JOIN members m_aluno ON s.student_id = m_aluno.member_id JOIN addresses a_aluno ON m_aluno.address_id = a_aluno.address_id JOIN programs p ON s.program_id = p.program_id JOIN members m_prof ON p.coordinator_id = m_prof.member_id JOIN addresses a_prof ON m_prof.address_id = a_prof.address_id WHERE a_aluno.city = a_prof.city;"
      }
    ]
  }
]
